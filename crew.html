<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ìˆ²ê¸¸ í¬ë£¨ ëª¨ì§‘í•˜ê¸°</title>
    <style>
        /* ìŠ¤íƒ€ì¼ ì½”ë“œ */
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            background-color: #f4f4f4;
        }

        h1 {
            text-align: center;
            background-color: #d1ecc6;
            color: black;
            padding: 10px;
            margin: 0;
        }

        .guestbook {
            background-color: #fff;
            padding: 20px;
            margin: 20px;
            border-radius: 5px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        .commentInput {
            width: 80%;
            padding: 10px;
            margin-bottom: 10px;
            border: 1px solid #ccc;
            border-radius: 3px;
        }

        .commentButton {
            padding: 10px 20px;
            background-color: #d1ecc6;
            color: black;
            border: none;
            border-radius: 3px;
            cursor: pointer;
        }

        .commentList {
            list-style: none;
            padding: 0;
        }

        .deleteButton {
            background-color: #ff6347;
            color: white;
            border: none;
            border-radius: 3px;
            cursor: pointer;
        }
        
        .entryTitle {
            font-size: 18px;
            font-weight: bold;
        }
        
        .entryName {
            font-size: 14px;
        }
    </style>
</head>
<body>
    <h1>ğŸŒ³ìˆ²ê¸¸ í¬ë£¨ ëª¨ì§‘í•˜ê¸°ğŸŒ³</h1>

    <!-- ëª¨ì§‘ê¸€ ì‘ì„± í¼ -->
    <div class="guestbook">
        <h2>âœï¸ìƒˆ ëª¨ì§‘ê¸€ ì‘ì„±</h2>
        <input type="text" class="commentInput" id="title" placeholder="ì œëª©ì„ ì…ë ¥í•˜ì„¸ìš”!">
        <input type="text" class="commentInput" id="name" placeholder="ì´ë¦„ì„ ì…ë ¥í•˜ì„¸ìš”!">
        <textarea class="commentInput" id="comment" placeholder="í¬ë£¨ ëª¨ì§‘ê¸€ì„ ë‚¨ê²¨ì£¼ì„¸ìš”!"></textarea>
        <button class="commentButton" onclick="addEntry()">ì‘ì„±</button>
    </div>

    <!-- ëª¨ì§‘ê¸€ í‘œì‹œ ì˜ì—­ -->
    <div id="guestbookEntries"></div>

    <script>
        // ëª¨ì§‘ê¸€ ë°ì´í„° ì´ˆê¸°í™”
        const guestbookData = JSON.parse(localStorage.getItem('guestbookData')) || [];

        // ëª¨ì§‘ê¸€ ì‘ì„±
        function addEntry() {
            const titleInput = document.getElementById('title');
            const nameInput = document.getElementById('name');
            const commentInput = document.getElementById('comment');
            const title = titleInput.value;
            const name = nameInput.value;
            const comment = commentInput.value;

            if (title.trim() === '' || name.trim() === '' || comment.trim() === '') {
                alert('ì œëª©, ì´ë¦„, ë‚´ìš©ì„ ëª¨ë‘ ì…ë ¥í•˜ì„¸ìš”.');
                return;
            }

            // ëª¨ì§‘ê¸€ ê°ì²´ ìƒì„±
            const entry = {
                title: title,
                name: name,
                comment: comment,
                comments: [] // ê° ëª¨ì§‘ê¸€ì— ëŒ€í•œ ëŒ“ê¸€ ëª©ë¡
            };

            // ëª¨ì§‘ê¸€ ë°ì´í„°ì— ì¶”ê°€
            guestbookData.push(entry);
            localStorage.setItem('guestbookData', JSON.stringify(guestbookData));
            // í™”ë©´ì— ëª¨ì§‘ê¸€ ì—…ë°ì´íŠ¸
            displayEntries();

            // ì…ë ¥ í•„ë“œ ì´ˆê¸°í™”
            titleInput.value = '';
            nameInput.value = '';
            commentInput.value = '';
        }

        // ëŒ“ê¸€ ì‘ì„±
        function addComment(entryIndex) {
            // entryIndexê°€ ìœ íš¨í•œì§€ í™•ì¸
            if (entryIndex < 0 || entryIndex >= guestbookData.length) {
                alert('ìœ íš¨í•˜ì§€ ì•Šì€ ëª¨ì§‘ê¸€ì…ë‹ˆë‹¤.');
                return;
            }

            const nameInput = document.querySelector(`#nameInput${entryIndex}`);
            const commentInput = document.querySelector(`#commentInput${entryIndex}`);
            const name = nameInput.value;
            const commentText = commentInput.value;

            if (name.trim() === '' || commentText.trim() === '') {
                alert('ì´ë¦„ê³¼ ëŒ“ê¸€ì„ ëª¨ë‘ ì…ë ¥í•˜ì„¸ìš”.');
                return;
            }

            // ëŒ“ê¸€ ê°ì²´ ìƒì„±
            const comment = {
                name: name,
                text: commentText
            };

            // í•´ë‹¹ ëª¨ì§‘ê¸€ì˜ ëŒ“ê¸€ ë°°ì—´ì´ ì •ì˜ë˜ì–´ ìˆëŠ”ì§€ í™•ì¸í•˜ê³ , ì •ì˜ë˜ì–´ ìˆì§€ ì•Šìœ¼ë©´ ì´ˆê¸°í™”
            if (!guestbookData[entryIndex].comments) {
                guestbookData[entryIndex].comments = [];
            }

            // í•´ë‹¹ ëª¨ì§‘ê¸€ì˜ ëŒ“ê¸€ ë°°ì—´ì— ëŒ“ê¸€ ì¶”ê°€
            guestbookData[entryIndex].comments.push(comment);

            // í™”ë©´ì— ëŒ“ê¸€ ì—…ë°ì´íŠ¸
            displayComments(entryIndex);

            // ì…ë ¥ í•„ë“œ ì´ˆê¸°í™”
            nameInput.value = '';
            commentInput.value = '';

            // ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ì— ëŒ“ê¸€ ë°ì´í„° ì—…ë°ì´íŠ¸
            localStorage.setItem('guestbookData', JSON.stringify(guestbookData));
        }

        // ê²Œì‹œë¬¼ ì‚­ì œ
        function deleteEntry(entryIndex) {
            // entryIndexê°€ ìœ íš¨í•œì§€ í™•ì¸
            if (entryIndex < 0 || entryIndex >= guestbookData.length) {
                alert('ìœ íš¨í•˜ì§€ ì•Šì€ ëª¨ì§‘ê¸€ì…ë‹ˆë‹¤.');
                return;
            }

            // í•´ë‹¹ ê²Œì‹œë¬¼ì„ ë°°ì—´ì—ì„œ ì œê±°
            guestbookData.splice(entryIndex, 1);

            // í™”ë©´ì—ì„œë„ í•´ë‹¹ ê²Œì‹œë¬¼ ì œê±°
            displayEntries();

            // ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ì— ì—…ë°ì´íŠ¸ëœ ë°ì´í„° ì €ì¥
            localStorage.setItem('guestbookData', JSON.stringify(guestbookData));
        }

        // ëª¨ì§‘ê¸€ í™”ë©´ì— í‘œì‹œ
        function displayEntries() {
            const guestbookEntries = document.getElementById('guestbookEntries');
            guestbookEntries.innerHTML = '';

            guestbookData.forEach((entry, index) => {
                const guestbookDiv = document.createElement('div');
                guestbookDiv.classList.add('guestbook');
                guestbookDiv.innerHTML = `
                    <h3 class="entryTitle">${entry.title}</h3>
                    <p class="entryName">${entry.name}</p>
                    <p>${entry.comment}</p>
                    <button class="deleteButton" onclick="deleteEntry(${index})">ì‚­ì œ</button>
                    <h4>ëŒ“ê¸€</h4>
                    <input type="text" class="commentInput" id="nameInput${index}" placeholder="ì´ë¦„ì„ ì…ë ¥í•˜ì„¸ìš”!">
                    <input type="text" class="commentInput" id="commentInput${index}" placeholder="ëŒ“ê¸€ì„ ì…ë ¥í•˜ì„¸ìš”">
                    <button class="commentButton" onclick="addComment(${index})">ëŒ“ê¸€ ì‘ì„±</button>
                    <ul class="commentList" id="commentList${index}">
                        <!-- ëŒ“ê¸€ì´ ì—¬ê¸°ì— ë‚˜íƒ€ë‚©ë‹ˆë‹¤ -->
                    </ul>
                `;

                guestbookEntries.appendChild(guestbookDiv);

                // í˜ì´ì§€ ë¡œë“œ ì‹œ ëŒ“ê¸€ì„ í‘œì‹œ
                displayComments(index);
            });
        }

        // ëŒ“ê¸€ í™”ë©´ì— í‘œì‹œ
        function displayComments(entryIndex) {
            const commentList = document.querySelector(`#commentList${entryIndex}`);
            commentList.innerHTML = '';

            if (guestbookData[entryIndex].comments) {
                guestbookData[entryIndex].comments.forEach(comment => {
                    const li = document.createElement('li');
                    li.textContent = `${comment.name}: ${comment.text}`;
                    commentList.appendChild(li);
                });
            }
        }

        // í˜ì´ì§€ ë¡œë“œ ì‹œ ì´ˆê¸° ë°ì´í„° í‘œì‹œ
        displayEntries();
    </script>
</body>
</html>
